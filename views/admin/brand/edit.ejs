
<%- include ../layout/header %> 
<style>
  .update-btn{
    margin-right:7px;
  }
</style>  
        

<!-- Middle Content Start -->

<div ng-controller="CateEditCtrl" class="vd_content-wrapper">
    <div class="vd_container">
      <div class="vd_content clearfix">
        <div class="vd_head-section clearfix">
          <div class="vd_panel-header">
            <ul class="breadcrumb">
              <li><a href="/admin">Dashboard</a> </li>
              <li class="active">Brand | Edit</li>
            </ul>

          </div>
        </div>
        <!-- vd_head-section -->
        
        <div class="vd_title-section clearfix">
          <div class="vd_panel-header">
            <h1>Brand | Edit</h1>
            <!-- <small class="subtitle">Default dashboard for multipurpose demonstration</small> -->
            <div class="vd_panel-menu  hidden-xs">
<!-- menu --> 
</div>



<!-- vd_panel-menu --> 
          </div>
          <!-- vd_panel-header --> 
        </div>
        <!-- vd_title-section -->
        








        <!-- Begin Content -->

          <div class="vd_content-section clearfix">
          <div class="panel widget light-widget">
            <div class="panel-heading no-title"> </div>
            <div class="panel-body">
              <h2 class="mgbt-xs-20">Brand | Edit</h2>

              

<!-- Begin AlertMgs -->

<%

var flash = getMessages();

if(flash.info){ %>


<div class="alert alert-info"> 
<button aria-hidden="true" data-dismiss="alert" class="close" type="button"><i class="icon-cross"></i></button>
<span class="vd_alert-icon"><i class="fa fa-info-circle vd_blue"></i></span>
<strong>Info : </strong> <a href="#" class="alert-link"><%= flash.info %></a>
</div>

<% }else if(flash.error){ %>

<div class="alert alert-danger"> 
<button aria-hidden="true" data-dismiss="alert" class="close" type="button"><i class="icon-cross"></i></button>
<span class="vd_alert-icon"><i class="fa fa-exclamation-circle vd_red"></i></span>
<strong>Error :</strong> <a href="#" class="alert-link"><%= flash.error %></a> 
</div>

<% }else if(flash.success){ %>

<div class="alert alert-success"> 
<button aria-hidden="true" data-dismiss="alert" class="close" type="button"><i class="icon-cross"></i></button>
<span class="vd_alert-icon"><i class="fa fa-check-circle vd_green"></i></span>
<strong>Success : </strong>  
<a href="#" class="alert-link"><%= flash.success %></a>. 
</div>

<% } %>
<!-- Begin AlertMgs -->




                



              <form id="CateForm" action="/admin/brand/update" method="POST"  class="form-horizontal"  role="form" id="register-form" novalidate="novalidate">
               
                  <% if(flash.id_err){ %>&nbsp;&nbsp;&nbsp;&nbsp;<small style="color:red;"><%= flash.id_err %></small>  <% } %>
                  <input name="id" value="<% if(brand.id){%><%= brand.id %><%}%>" type="hidden">
                 

              
                                  
                <div class="form-group">
                  <div class="col-md-12">
                    <label class="control-label  col-sm-2">Arabic <span class="vd_red">*</span></label>
                    <% if(flash.ar_name_err){ %>&nbsp;&nbsp;&nbsp;&nbsp;<small style="color:red;"><%= flash.ar_name_err %></small>  <% } %>
                    <div id="first-name-input-wrapper" class="controls col-sm-9">
                      <input name="ar_name" value="<% if(brand.ar_name){%><%= brand.ar_name %><%}%>" type="text" placeholder="Arabic Name" class="width-60 required"  id="ArInput" required="">
                    </div>
                  </div>
                </div>  
                


                <div class="form-group">
                    <div class="col-md-12">          
                      <label class="control-label  col-sm-2">English <span class="vd_red">*</span></label>
                      <% if(flash.en_name_err){ %>&nbsp;&nbsp;&nbsp;&nbsp;<small style="color:red;"><%= flash.en_name_err %></small>  <% } %>
                      <div id="first-name-input-wrapper" class="controls col-sm-9">
                        <input name="en_name" value="<% if(brand.en_name){%><%= brand.en_name %><%}%>" type="text" placeholder="Englis Name" class="width-60 required"  id="EnInput" required="">
                      </div>
                    </div>
                </div>
                
                
            
          
                 
          <div class="form-group">
                  <div class="col-md-12">
                    <label class="control-label col-sm-2">Status<span class="vd_red">*</span></label>
                    <div id="email-input-wrapper" class="controls col-sm-6">
                      <% if(flash.status_err){ %> <small style="color:red;"><%= flash.status_err %></small>  <% } %>
                      <select name="status" id="StatusSelect" >
                        <option value="" >Select Status</option>
                        <option value="1" <% if(brand.status && brand.status=='1' ){ %> selected="true" <% } %> >Active</option>
                        <option value="0" <% if(brand.status && brand.status=='0' ){ %> selected="true" <% } %> >Deactive</option>
                      </select>
                    </div>
                  </div>
          </div>            






        


                <div id="vd_login-error" class="alert alert-danger hidden"><i class="fa fa-exclamation-circle fa-fw"></i> Please fill the necessary field </div>
                <div class="form-group">
                  <div class="col-sm-2"></div>
                  
                  
                  <div class="col-md-6 mgbt-xs-10 mgtp-20">

                    <div class="mgtp-10">
                      <button  class="btn vd_bg-green vd_white" type="submit" id="submit-register" name="submit-register">Update</button>
                      <a href="/admin/brand/list" class="btn vd_bg-green vd_white" >Cancel</a>
                    </div>
                  </div> 


                  <div class="col-md-12 mgbt-xs-5"> </div>
                </div>
              </form>





      




            </div>
          </div>
        </div>
        


          

        <!-- End Content -->





     
        
      </div>
      <!-- .vd_content --> 
    </div>
    <!-- .vd_container --> 
</div>
  <!-- .vd_content-wrapper --> 
  
  <!-- Middle Content End --> 
  
</div>
<!-- .container --> 
</div>
<!-- .content -->



<script>
app.controller('CateEditCtrl',function($scope) 
{


  $scope.mode='create';
  $scope.errors={};
  $scope.subcate={};
  $scope.subcates=JSON.parse($("#subcategoriesInput").val());

  //alert($("#subcategoriesInput").val())
  
  //$scope.subcates.push({id:1,ar:'1arabic',en:'1english',priority:1,status:1});
  //$scope.subcates.push({id:2,ar:'2arabic',en:'2english',priority:2,status:1});
  // $scope.subcates.push({id:3,ar:'arabic',en:'english',priority:786,status:1});
  // $scope.subcates.push({id:4,ar:'arabic',en:'english',priority:786,status:1});
  // $scope.subcates.push({id:5,ar:'arabic',en:'english',priority:786,status:1});
  
  $("#CateForm").on("submit",function()
  {
    $("#subcategoriesInput").val(JSON.stringify($scope.subcates));
    
  });


  $scope.SubcateCreate = function()
  {
      $scope.errors={};
      if(!$scope.subcate.status){$scope.errors.status=`Status is required.`; }
      if(!$scope.subcate.priority){$scope.errors.priority=`Priority name is required.`; }
      if(!$scope.subcate.ar||$scope.subcate.ar.trim()===''){$scope.errors.ar=`Arabic name is required.`; }
      if(!$scope.subcate.en||$scope.subcate.en.trim()===''){$scope.errors.en=`Englis name is required.`; }
      if(Object.keys($scope.errors).length>0){ }
      else
      { 
        let create={}
        create.ar=$scope.subcate.ar;
        create.en=$scope.subcate.en;
        create.status=$scope.subcate.status;
        create.priority=$scope.subcate.priority;        
        create.id=Math.random()+window.performance.now(); 
        $scope.subcates.push(create); //$scope.subcate={};
      
      }

  }


  $scope.SubcateEdit = function(index)
  {
      $scope.errors={};
      $scope.subcate={};
      $scope.mode='edit';
      const row = $scope.subcates[index];
      $scope.subcate.id=row.id;
      $scope.subcate.ar=row.ar;
      $scope.subcate.en=row.en;
      $scope.subcate.status=row.status;
      $scope.subcate.priority=row.priority;
      alert(`Your edit data appeared in subcategory section`); 
        
  }


  $scope.SubcateUpdate = function()
  {
      $scope.errors={};
      if(!$scope.subcate.status){$scope.errors.status=`Status is required.`; }
      if(!$scope.subcate.priority){$scope.errors.priority=`Priority name is required.`; }
      if(!$scope.subcate.ar||$scope.subcate.ar.trim()===''){$scope.errors.ar=`Arabic name is required.`; }
      if(!$scope.subcate.en||$scope.subcate.en.trim()===''){$scope.errors.en=`Englis name is required.`; }
      if(!$scope.subcate.id||$scope.subcates.findIndex(row =>row.id==$scope.subcate.id)==-1){ $scope.errors.idn=`Id is not exists`; alert($scope.errors.id); }
   
      //alert(JSON.stringify($scope.subcate));

      if(Object.keys($scope.errors).length>0){ }
      else
      { 

          const index =  $scope.subcates.findIndex(row =>row.id==$scope.subcate.id);
          
          //$scope.subcates[index] = $scope.subcate  ;
          $scope.subcates[index].id=$scope.subcate.id;
          $scope.subcates[index].ar=$scope.subcate.ar;
          $scope.subcates[index].en=$scope.subcate.en;
          $scope.subcates[index].status=$scope.subcate.status;
          $scope.subcates[index].priority=$scope.subcate.priority;
          $scope.errors={}; $scope.subcate={}; $scope.mode='create';

      }

  }
  
  $scope.SubcateEditCancel = function(index)
  {
      $scope.subcate={};
      $scope.mode='create';
      
  }

  $scope.SubcateDel = function(index)
  {

    let row = $scope.subcates[index];
    if(confirm(`Are you sure you want to delete sub category ?`))  
    //if(confirm(`Do you want to delete (${row.id}) Arabic:${row.ar},English:${row.en} Subcategory.`))
    {

        $scope.subcates.splice(index,1);
        // $(`#tr-${index}`).children('td, th')
        //       .animate({ padding: 0 })
        //       .wrapInner('<div />')
        //       .children()
        //       .slideUp(function(){
        //         $(this).closest('tr').remove();
        //         setTimeout(function(){ $scope.subcates.splice(1,index); 
        //       },1000);
        // });

    }
    
    


  }

});
</script>

        
<%- include ../layout/footer %> 
